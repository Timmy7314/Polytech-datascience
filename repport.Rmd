---
title: "Wine Quality"
author: "Alexandre SALMON, Thomas FRION"
date: "13/01/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("ggplot2")
library("reshape2")
library("GGally")

```

# 1 Objectif de l'étude

Notre étude va porter sur la qualité des vins portugais, de la région Vinho Verde. Nos objectifs via cette étude sont : 

* Déterminer un modèle de prédiction de la qualité d'un vin rouge et d'un vin blanc. Ainsi, connaitre le critère physionomique le plus important dans la détermination de la qualité pour chaque type de vin.
* Comparer les deux modèles (blanc et rouge) pour savoir si ce qui vait un bon vin blanc, fait un bon vin rouge

Les conclusions de cette étude pourront permettre aux vignerons d'améliorer la qualité de leurs vins.

# 2 Analyse descriptive

Pour cette étude nous disposons de deux jeux de données : un pour le vin rouge et 1 pour le vin blanc. Nous avons obtenu ces données sur la page [UCI: Wine Quality Data Set](https://archive.ics.uci.edu/ml/datasets/Wine+Quality) 

Pour les deux jeux de données nous avons douze variables: onze variables d'entrée qui correspondent aux critères physionomiques du vin et une variable de sortie qui correspond à la qualité du vin en 0 et 10.
Les onze critères physionomiques sont les suivantes : 

1. Acidité fixe (ou acidité naturelle du raisin)
2. Acidité volatile (teneur d'acides gras)
3. Acide citrique (teneur d'acide citrique)
4. Sucre résiduel (sucres encore présents après la fermentation)
5. Chlorures (teneur des différents chlorures)
6. Dioxyde de soufre ($SO_2$) libre (teneur du principe actif du $SO_2$)
7. Total du dioxyde de soufre ($SO_2$) (teneur de toutes les formes du $SO_2$)
8. Densité
9. pH
10. Sulfates (teneur du fongicide)
11. Alcool

La variable de sortie correspond à la médianne des notes données par des experts (au minimun trois notes). Si la variable vaut 0 sela signifie que le vin est de très mauvaise qualité. Si la variable vaut 10 alors le vin est de bonne qualité.

Nous avons 1599 vins rouges et 4898 vins blancs.

```{r}
RWine <- read.csv("./data/winequality-red.csv", sep = ";"); 
WWine <- read.csv("./data/winequality-white.csv", sep = ";");
```

Afin de connaître les liens entre les variables d'entrée, nous avons décidé de calculer la corrélation entre les différentes variables. Ce calcul nous a données les résultats suivants :

```{r}
WWine['type']='White'
RWine['type']='Red'
AWine<-rbind(RWine, WWine)
AWine.m <- melt(AWine, id.var = "type")

ggcorr(AWine[, -1], geom = "blank", label = TRUE, hjust = 0.75) +
  geom_point(size = 10, aes(color = coefficient > 0, alpha = abs(coefficient) > 0.5)) +
  scale_alpha_manual(values = c("TRUE" = 0.25, "FALSE" = 0)) +
  guides(color = FALSE, alpha = FALSE)
```


Nous pouvons observer dans les résultats ci-desssus, qu'il y a des corrélations positives et négatives. Par exemple, la densité et l'alcool ont une corrélation négative : cela signifie que plus il y a d'alcool moins le vin est dense. À l'inverse, le $SO_2$ libre et le $SO_2$ total ont une corrélation positive. Ce qui signifie que plus il y a de $SO_2$ libre plus la teneur totale de $SO_2$ sera importante.

Nous avons choisis de faire le calcul des corrélations afin d'avoir une vision d'ensemble des liens entre les variables. Ainsi nous pouvons faire un plot plus lisible des données pour mieux apprécier les liens.

```{r}

```

```{r}
AWine$type<-NULL

arr = c()
for (i in 2:15) {
  res <- kmeans(AWine,i)
  arr<-c(arr,res$tot.withinss/res$totss)
}

plot(arr)
```